# config/baseline_single.yaml
experiment:
  name: "baseline_single_agent"
  description: "Single agent baseline"
  timestamp: null  # Auto-generated if null

llm:
  provider: "openai"  # "ollama, "openai", "anthropic"
  model: "gpt-4o-mini"
  # provider: "ollama"  # "ollama, "openai", "anthropic"
  # model: "gemma3:270m"
  # model: "gpt-oss:latest"
  provider: "anthropic"
  model: "claude-sonnet-4-20250514"
  temperature: 1  # 0.0 for reproducibility, higher for creativity

workflow:
  type: "single_agent"
  agent_sequence: ["main"]  # Order of agent execution
  max_total_iterations: 10  # Maximum iterations for multi-agent workflows
  final_output_structured:
    enabled: false
    schema: null

agents:
  main:
    system_prompt: |
      You are an expert log analyst. Analyze system logs to:
      1. Identify key events and state changes
      2. Map events to intent expectations if intent is provided
      3. Determine if system is compliant or degraded
      4. Provide clear, factual explanations

      Be concise and evidence-based. Only cite information from logs.

      IMPORTANT - OUTPUT FORMAT:
      You MUST structure your response in the following format:

      1. First, output a JSON code block with your structured analysis:
      ```json
      {
        "events_detected": [
          {
            "event_type": "vm_started",
            "instance_id": "...",
            "timestamp": "YYYY-MM-DD HH:MM:SS.mmm",
            "description": "What happened",
            "confidence": "high|medium|low",
            "line_number": 123
          }
        ],
        "timeline": [
          {"event": "Brief description", "time": "HH:MM:SS.mmm"}
        ],
        "metrics": {
          "metric_name_seconds": 19.84,
          "another_metric": 5.8
        },
        "anomalies": [
          {"type": "error|warning|performance", "description": "...", "severity": "low|medium|high"}
        ],
        "compliance_status": "COMPLIANT|DEGRADED|NON_COMPLIANT"
      }
      ```

      2. Then provide your narrative explanation below the JSON.

      The JSON MUST be valid and parseable. Include ALL events you find, with their exact instance IDs and timestamps from the logs.
    tools:
      - read_file
      # - search_logs
    max_tokens: 16384
    max_iterations: 10
    temperature: null  # Uses llm.temperature if null, can override per-agent
    provider: "ollama"  # Uses llm.provider if null
    model: "qwen3:4b-instruct"  # Uses llm.model if null
    api_key: null  # Uses llm.api_key if null
    base_url: null  # Uses llm.base_url if null
    structured_output:
      enabled: true
      schema: "AnomalyDetectionOutput"

data:
  # log_source: "data/logs/openstack-medium/openstack_200.log"
  log_source: "data/logs/openstack/nova-api.log"
  intent_source: "data/intents/nova_api_latency_intent/nova_api_latency_intent.ttl"
  # intent_source: null  # "data/intents/synthetic_intent_1.json"
  index_method: "simple"  # or "vector"
  chunk_size: 1000

evaluation:
  metrics:
    - accuracy
    - completeness
    - coherence
  output_dir: "experiments/results/baseline_single/"